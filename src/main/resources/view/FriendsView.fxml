<?xml version="1.0" encoding="UTF-8"?>

<?import com.jfoenix.controls.JFXButton?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<StackPane styleClass="page-container" stylesheets="@../styles/styles.css"
           xmlns="http://javafx.com/javafx/17"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="com.saferoom.gui.controller.FriendsController">

    <VBox spacing="0" StackPane.alignment="TOP_CENTER">
        <padding>
            <Insets bottom="0" left="5" right="5" top="10" />
        </padding>

        <!-- HEADER: Title + Stats -->
        <HBox styleClass="friends-modern-header" spacing="20" alignment="CENTER_LEFT">
            <VBox spacing="4" HBox.hgrow="ALWAYS">
                <Label text="Friends" styleClass="friends-main-title" />
                <Label text="Connect with your network" styleClass="friends-subtitle-text" />
            </VBox>

            <!-- Stats Cards -->
            <HBox spacing="12" styleClass="friends-stats-compact">
                <VBox styleClass="stat-card-mini" alignment="CENTER" spacing="2">
                    <Label text="0" fx:id="onlineCountLabel" styleClass="stat-mini-number" />
                    <Label text="Online" styleClass="stat-mini-label" />
                </VBox>

                <VBox styleClass="stat-card-mini" alignment="CENTER" spacing="2">
                    <Label text="0" fx:id="totalCountLabel" styleClass="stat-mini-number" />
                    <Label text="Total" styleClass="stat-mini-label" />
                </VBox>

                <VBox styleClass="stat-card-mini" alignment="CENTER" spacing="2">
                    <Label text="0" fx:id="pendingCountLabel" styleClass="stat-mini-number" />
                    <Label text="Pending" styleClass="stat-mini-label" />
                </VBox>
            </HBox>

            <VBox.margin>
                <Insets bottom="20" />
            </VBox.margin>
        </HBox>

        <!-- SEARCH + ADD FRIEND -->
        <HBox spacing="12" alignment="CENTER_LEFT" styleClass="friends-action-bar">
            <TextField fx:id="searchField"
                       promptText="Search friends..."
                       styleClass="friends-search-input"
                       HBox.hgrow="ALWAYS" />

            <JFXButton fx:id="addFriendButton" styleClass="friends-add-btn">
                <graphic>
                    <HBox spacing="8" alignment="CENTER">
                        <FontIcon iconLiteral="fas-user-plus" styleClass="add-friend-icon-modern" />
                        <Label text="Add Friend" styleClass="add-friend-text-modern" />
                    </HBox>
                </graphic>
            </JFXButton>

            <VBox.margin>
                <Insets bottom="16" />
            </VBox.margin>
        </HBox>

        <!-- FILTER TABS -->
        <HBox fx:id="filterBar" styleClass="friends-filter-bar-modern" spacing="8" alignment="CENTER_LEFT">
            <JFXButton fx:id="onlineFilterButton" styleClass="filter-pill-button">
                <graphic>
                    <HBox spacing="6" alignment="CENTER">
                        <FontIcon iconLiteral="fas-circle" styleClass="filter-icon-online" />
                        <Label text="Online" styleClass="filter-pill-text" />
                    </HBox>
                </graphic>
            </JFXButton>

            <JFXButton fx:id="allFilterButton" styleClass="filter-pill-button">
                <graphic>
                    <HBox spacing="6" alignment="CENTER">
                        <FontIcon iconLiteral="fas-users" styleClass="filter-icon" />
                        <Label text="All Friends" styleClass="filter-pill-text" />
                    </HBox>
                </graphic>
            </JFXButton>

            <JFXButton fx:id="pendingFilterButton" styleClass="filter-pill-button">
                <graphic>
                    <HBox spacing="6" alignment="CENTER">
                        <FontIcon iconLiteral="fas-clock" styleClass="filter-icon-pending" />
                        <Label text="Pending" styleClass="filter-pill-text" />
                    </HBox>
                </graphic>
            </JFXButton>

            <JFXButton fx:id="blockedFilterButton" styleClass="filter-pill-button">
                <graphic>
                    <HBox spacing="6" alignment="CENTER">
                        <FontIcon iconLiteral="fas-ban" styleClass="filter-icon-blocked" />
                        <Label text="Blocked" styleClass="filter-pill-text" />
                    </HBox>
                </graphic>
            </JFXButton>

            <VBox.margin>
                <Insets bottom="16" />
            </VBox.margin>
        </HBox>

        <!-- FRIENDS LIST HEADER -->
        <Label fx:id="listHeaderLabel"
               text="ALL FRIENDS â€” 0"
               styleClass="friends-list-header-modern">
            <VBox.margin>
                <Insets bottom="8" />
            </VBox.margin>
        </Label>

        <!-- OPTIMIZED LISTVIEW - VIRTUALIZED -->
        <ListView fx:id="friendsListView"
                  styleClass="friends-list-view-optimized"
                  VBox.vgrow="ALWAYS">
            <VBox.margin>
                <Insets top="0"/>
            </VBox.margin>
        </ListView>

    </VBox>

    <!-- SEARCH RESULTS DROPDOWN -->
    <ListView fx:id="searchResultsList"
              visible="false"
              prefHeight="80"
              styleClass="friends-search-results"
              maxHeight="300"
              StackPane.alignment="TOP_CENTER">
        <StackPane.margin>
            <Insets top="170" left="20" right="20" />
        </StackPane.margin>
    </ListView>

</StackPane>